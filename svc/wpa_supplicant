NAME="WPA Supplicant"
DAEMON="wpa_supplicant"

main() {
	if [ ! -r /etc/leaninit/wpa.cfg ]; then
		echo "Failed to start $NAME because /etc/leaninit/wpa.cfg does not exist!"
		return 1
	fi
	if [ -r /etc/leaninit/svce/devd ]; then
		while true; do
			if [ "`pgrep -x wpa_supplicant`" != "" ]; then
				pkill -x wpa_supplicant
				break
			fi
		done
	fi
	. /etc/leaninit/wpa.cfg
	sleep 2
	wpa_supplicant -s -B -Dbsd -i${INTERFACE} -c/etc/wpa_supplicant.conf
}
